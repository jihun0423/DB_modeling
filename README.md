# DB_modeling

RDBMS에서 데이터 모델링을 할 때에는 정규화를 통해 데이터 중복을 최소화 할 수 있게 설계해야 합니다. 그래야 삽입 이상, 삭제 이상, 갱신 이상 등 이상현상들을 방지할 수 있으며, 데이터 무결성을 지킬 수 있습니다.   


DB설계 단계
1. 요구사항 명세서나, 제공된 UI에 필요한 데이터 필드들을 파악.
2. 비슷한 필드들끼리 묶어서 엔티티 형성
3. 정규형을 고려하여 정규화

정규화 6단계

규칙1.
  - DB내에 모든 값들은 원자값이여야만 함. 즉, 하나의 정보만 담고 있어야 함. 이를 위해서 행을 분리하던지, 혹은 아예 다른 테이블로 옮겨서 외래키로 만드는 방법을 사용 가능함.
    - 이를테면, 학생 테이블에 학생 이름과 수강하는 과목이 여러가지가 있다고 한다면, 과목 테이블을 따로 만들고, 그 과목에 수강하는 학생 컬럼을 외래키로 형성하여 학생 테이블의 이름을 참조하는 형식으롬 만들면 된다.
       (이 때 기본키의 경우 학생 테이블에서는 학생 ID를 사용하거나, 혹은 Auto-Increment를 사용하고, 과목 테이블에서는 기본키로 Auto_increment를 사용한다)

      
규칙2.
  - 어떤 테이블에 FK를 넣어도 규칙1을 만족하지 못할 경우, 중간 테이블을 하나 더 만들어라.  

규칙3. 
  - 헷갈릴 때는 테이블 간의 관계 (1:1, 1:N, N:M) 를 떠올려라.
  - 꿀팁 : 명사 2개를 적어 놓고, 그들간의 동사를 써서 파악한다.
    - ex) 유저는 이메일을 ㅇㅇㅇㅇ. 이메일은 유저를 ㅇㅇㅇㅇ. -> 동사를 포함한다, 포함되어진다 라고 생각하면 맞음.
  - 이 뒤, 관계를 파악한다.
    - 유저는 이메일을 N개 소유한다. 이메일은 유저 1명에게 포함되어진다.  ->  이런 경우는 1:N 관계이다
  - 1:N 관계일 경우, N쪽에 반드시 FK가 들어가야한다.

  - N:M 관계일 때에는, 새로운 테이블을 만들어서 각 테이블의 PK를 FK로 사용하도록 한다.
    - ex) 영화, 배우 테이블이 존재할 경우
        - 하나의 영화에 여러명의 배우가 출연한다. 하나의 배우가 여러개의 영화에 출연한다.   ->  N:M 관계이다.
        - 이런식으로 N:M일 경우, 영화출연목록 테이블을 새로 만든 뒤, 영화 ID, 배우 ID를 FK로 가지도록 하면 된다.
  - 1:1 관계일 경우, 어느쪽에 FK가 들어가도 문제가 없다.
    - 다만, 테이블 2개를 합쳐도 되는지를 꼭 고려해본다. 굳이 1:1 테이블 2개로 분리하는 것보다, 하나의 테이블로 합쳐도 문제가 없는 경우는 합치는 것이 더욱 낫기 때문.

규칙4. 
  - 데이터 중복이 발생하는 컬럼이 있는지 확인해라.
    - 단, FK가 중복일 경우에는 상관 없음. FK가 참조하고 있는 기본키 값을 하나만 수정해도 FK에 있는 값 전체가 수정되기 때문. 이 규칙에서 데이터 중복을 확인하려는 이유는 하나의 값을 수정했을 때, 다른 값들도 변경되어야 하기 때문.

규칙5.
  - 가짜 중복인지, 진짜 중복인지 생각해보라.
  - 실제 서비스에서 A데이터의 값을 수정하면, B데이터의 값도 수정되어야 하는가?
    - ex) 게시판에 있는 게시글의 작성자 이름이 바뀌었을 경우, 그 작성자의 다른 게시글들의 작성자 이름도 바뀌어야 하므로 진짜 중복. 테이블 분리가 필요하다.
    - 그러나 만약 우연히 게시글의 제목이 중복일 때, 한 게시글의 제목이 바뀌었다고 해서 다른 게시글의 제목이 바뀔 필요는 없다.
  - 즉, 가짜 중복일 경우에는 테이블 분리를 하면 안되고, 진짜 중복일 때에만 테이블 분리를 해야한다. 
